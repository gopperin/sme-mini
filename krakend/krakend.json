{
    "version": 2,
    "name": "gopper.in gateway",
    "port": 18080,
    "timeout": "10s",
    "plugin": {
        "pattern": ".so",
        "folder": "./plugins"
    },
    "endpoints": [
        {
            "endpoint": "/health",
            "extra_config": {
                "github.com/devopsfaith/krakend/proxy": {
                    "static": {
                        "data": {
                            "status": "OK"
                        },
                        "strategy": "always"
                    }
                }
            },
            "backend": [
                {
                    "url_pattern": "/health",
                    "host": [
                        "http://127.0.0.1:4000"
                    ]
                }
            ]
        },
        {
            "endpoint": "/validate",
            "method": "POST",
            "extra_config": {
                "github.com/devopsfaith/krakend-jose/validator": {
                    "alg": "HS256",
                    "kid": "gopperin",
                    "jwk-url": "http://127.0.0.1:4000/jwk/gopperin",
                    "disable_jwk_security": true
                }
            },
            "backend": [
                {
                    "url_pattern": "/validate",
                    "host": [
                        "http://127.0.0.1:4000"
                    ]
                }
            ]
        },
        {
            "endpoint": "/validate1",
            "method": "POST",
            "extra_config": {
                "github.com/devopsfaith/krakend-jose/validator": {
                    "alg": "HS256",
                    "kid": "greencomb",
                    "jwk-url": "http://127.0.0.1:4000/jwk/greencomb",
                    "disable_jwk_security": true
                }
            },
            "backend": [
                {
                    "url_pattern": "/validate",
                    "host": [
                        "http://127.0.0.1:4000"
                    ]
                }
            ]
        },
        {
            "endpoint": "/signin",
            "method": "POST",
            "backend": [
                {
                    "url_pattern": "/signin",
                    "host": [
                        "http://127.0.0.1:4000"
                    ]
                }
            ]
        },
        {
            "endpoint": "/user/base-profile/{id}",
            "method": "GET",
            "concurrent_calls": 3,
            "extra_config": {
                "github.com/devopsfaith/krakend-ratelimit/juju/router": {
                    "maxRate": 50,
                    "clientMaxRate": 5,
                    "strategy": "ip"
                },
                "github.com/devopsfaith/krakend-circuitbreaker/gobreaker": {
                    "interval": 60,
                    "timeout": 10,
                    "maxErrors": 1,
                    "name": "cb-myendpoint-1",
                    "logStatusChange": true
                }
            },
            "backend": [
                {
                    "url_pattern": "/base/{id}",
                    "method": "GET",
                    "host": [
                        "http://127.0.0.1:4000"
                    ],
                    "deny": [
                        "pwd"
                    ],
                    "allow": [
                        "name"
                    ]
                },
                {
                    "url_pattern": "/profile",
                    "method": "POST",
                    "host": [
                        "http://127.0.0.1:11914"
                    ],
                    "deny": [
                        "age"
                    ],
                    "allow": [
                        "work"
                    ],
                    "mapping": {
                        "work": "occupation"
                    },
                    "group": "profile"
                }
            ]
        },
        {
            "endpoint": "/create_user",
            "method": "POST",
            "backend": [
                {
                    "url_pattern": "/base/create",
                    "method": "POST",
                    "host": [
                        "http://127.0.0.1:14000"
                    ]
                }
            ]
        },
        {
            "endpoint": "/hotel-destinations/{id}",
            "method": "GET",
            "backend": [
                {
                    "host": [
                        "http://127.0.0.1:4000"
                    ],
                    "method": "POST",
                    "url_pattern": "/hotels/{id}"
                },
                {
                    "host": [
                        "http://127.0.0.1:11914"
                    ],
                    "method": "POST",
                    "url_pattern": "/destinations/{resp0_destination_id}"
                }
            ],
            "extra_config": {
                "github.com/devopsfaith/krakend/proxy": {
                    "sequential": true
                }
            }
        }
    ],
    "extra_config": {
        "github_com/devopsfaith/krakend-cors": {
            "allow_origins": [
                "*"
            ],
            "allow_methods": [
                "GET",
                "HEAD",
                "POST"
            ],
            "expose_headers": [
                "Content-Length",
                "Content-Type"
            ],
            "max_age": "12h",
            "allow_headers": [
                "Accept-Language"
            ],
            "allow_credentials": false
        },
        "github_com/devopsfaith/krakend/transport/http/server/handler": {
            "name": [
                "router-plugin",
                "signature-verify"
            ],
            "app": {
                "gopperin": "f6755f072cc5",
                "greencomb": "f6755f072cc4"
            }
        }
    }
}